#+TITLE: I3blocks config
#+AUTHOR: Kuhy
#+OPTIONS: prop:t

#+INCLUDE: "../variables.org"

* Bar
:PROPERTIES:
:header-args: :tangle ~/.config/i3blocks/config :comments both :mkdirp yes :noweb tangle
:END:
** Global
#+BEGIN_SRC conf
command=printf "%s<span font=''> </span>%s\n" "$(eval $ICON)" "$(eval $EXEC)"
align=center
markup=pango
SCRIPTS_FOLDER=/home/okuhejda/.config/i3blocks
#+END_SRC

** Time
#+BEGIN_SRC conf
[Time]
ICON=echo 
EXEC=date '+%a %d.%m. %T'
interval=1
min_width=250
#+END_SRC

** Keyboard
#+BEGIN_SRC conf
[Keyboard]
ICON=echo 
EXEC=$SCRIPTS_FOLDER/key
interval=1
min_width=70
#+END_SRC

** Volume
#+BEGIN_SRC conf
[volume]
ICON=echo 
EXEC=amixer | grep -m 1 -o -E [[:digit:]]+% | tr -d "%"
interval=1
min_width=70
#+END_SRC

** Battery
#+BEGIN_SRC conf
[battery]
ICON=$SCRIPTS_FOLDER/bat_ic
EXEC=$SCRIPTS_FOLDER/bat
interval=10
min_width=70
#+END_SRC

* Scripts
** Keyboard
:PROPERTIES:
:header-args: :tangle ~/.config/i3blocks/key :comments both :shebang "#!/bin/env bash" :mkdirp yes :noweb tangle
:END:
#+BEGIN_SRC sh
LAYOUT=$(swaymsg -t get_inputs | grep -m 1 -o '"xkb_active_layout_name":.*",' \
    | awk '{print  substr ($2, 2, 2)}')

if [ "$LAYOUT" = En ]; then
    echo "$LAYOUT"
else
    echo "<span color='<<base0E>>'>$LAYOUT</span>"
fi
#+END_SRC

** Battery
:PROPERTIES:
:header-args: :tangle ~/.config/i3blocks/bat :comments both :shebang "#!/bin/env bash" :mkdirp yes :noweb tangle
:END:
#+BEGIN_SRC sh
BATTERY=$(cat /sys/class/power_supply/BAT0/capacity)

if [ "$BATTERY" -gt 10 ]; then
    echo "$BATTERY"
else
    echo "<span color='<<base08>>'>$BATTERY</span>"
fi
#+END_SRC

** Battery icon
:PROPERTIES:
:header-args: :tangle ~/.config/i3blocks/bat_ic :comments both :shebang "#!/bin/env bash" :mkdirp yes :noweb tangle
:END:
#+BEGIN_SRC sh
if [ "$(cat /sys/class/power_supply/BAT0/status)" = Discharging ]; then
    echo 
else
    echo 
fi
#+END_SRC
